<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <title>EUchecklist</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>

<body>
<div class="row g-0">
    <div class="col-12 col-md-4 col-lg-3">
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">A1</h4><button id="item1" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">A2</h4><button id="item2" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">A3</h4><button id="item3" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">NI 1</h4><button id="item4" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">NI 2</h4><button id="item5" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">NI 3</h4><button id="item6" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">NI 4</h4><button id="item7" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">NI 5</h4><button id="item8" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
    </div>
    <div class="col">
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 1-1</h4><button id="item9" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 2-1</h4><button id="item10" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 2-2</h4><button id="item11" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 2-3</h4><button id="item12" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Owl</h4><button id="item13" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
    </div>
    <div class="col">
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 3-1</h4><button id="item14" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 3-2</h4><button id="item15" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 3-3</h4><button id="item16" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Ark 3-4</h4><button id="item17" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
        <div class="card">
            <div class="card-body d-flex justify-content-between align-items-center">
                <h4 class="card-title">Gaunlet</h4><button id="item18" class="btn btn-primary border-0 shadow-none" type="button">Click me</button>
            </div>
            <div class="card-footer" style="text-align: right;"><span class="text-muted">00:00</span></div>
        </div>
    </div>
</div>
</body>
<script>
    const items = [
        "item1", "item2", "item3", "item4", "item5",
        "item6", "item7", "item8", "item9", "item10",
        "item11", "item12", "item13", "item14", "item15",
        "item16", "item17", "item18", "item19"
    ];

    function setupTimerForItem(itemId) {
        const item = document.getElementById(itemId);
        let itemTimer;
        const itemDuration = 24 * 60 * 60;

        function startItemTimer() {
            let timeLeft = itemDuration;
            restartItemTimer(timeLeft);
            saveItemStartTimeToLocalStorage(itemId, Date.now());
        }

        item.addEventListener("click", () => {
            clearInterval(itemTimer);
            timeLeft = itemDuration;
            startItemTimer();
        });

        function restartItemTimer(timeLeft) {
            clearInterval(itemTimer);
            itemTimer = setInterval(() => {
                timeLeft--;
                let hours = Math.floor(timeLeft / 3600);
                let minutes = Math.floor((timeLeft % 3600) / 60);
                let seconds = Math.floor(timeLeft) % 60;
                let remainingTime = `${hours}h ${minutes}m ${seconds}s`;
                document.querySelector(`#${itemId}`).parentElement.nextElementSibling.querySelector("span").textContent = remainingTime;
                saveItemRemainingTimeToLocalStorage(itemId, timeLeft);
                if (timeLeft > 0) {
                    item.classList.remove("btn-primary");
                    item.classList.add("btn-secondary");
                } else {
                    clearInterval(itemTimer);
                    item.classList.remove("btn-secondary");
                    item.classList.add("btn-primary");
                }
            }, 1000);
        }

        function checkForItemStartTime() {
            const startTime = getItemStartTimeFromLocalStorage(itemId);
            if (startTime) {
                let timeLeft = itemDuration - (Date.now() - startTime) / 1000;
                if (timeLeft < 0) {
                    timeLeft = 0;
                }
                restartItemTimer(timeLeft);
            }
        }

        function getItemStartTimeFromLocalStorage(itemId) {
            const itemData = loadItemDataFromLocalStorage(itemId);
            return itemData ? itemData.startTime : null;
        }

        function saveItemStartTimeToLocalStorage(itemId, startTime) {
            const itemData = loadItemDataFromLocalStorage(itemId) || {};
            itemData.startTime = startTime;
            saveItemDataToLocalStorage(itemId, itemData);
        }

        function saveItemRemainingTimeToLocalStorage(itemId, timeLeft) {
            const itemData = loadItemDataFromLocalStorage(itemId) || {};
            itemData.remainingTime = timeLeft;
            saveItemDataToLocalStorage(itemId, itemData);
        }

        function loadItemDataFromLocalStorage(itemId) {
            const itemDataStr = localStorage.getItem(`item${itemId}`);
            return itemDataStr ? JSON.parse(itemDataStr) : null;
        }

        function saveItemDataToLocalStorage(itemId, itemData) {
            localStorage.setItem(`item${itemId}`, JSON.stringify(itemData));
        }

        checkForItemStartTime();
    }

    // Setup timers for all items
    items.forEach(itemId => setupTimerForItem(itemId));

    // Function to handle browser close event (not supported in all browsers)
    function handleBeforeUnload() {
        items.forEach(itemId => {
            const startTime = getItemStartTimeFromLocalStorage(itemId);
            if (startTime) {
                const timeLeft = getItemRemainingTimeFromLocalStorage(itemId);
                saveItemRemainingTimeToSessionStorage(itemId, timeLeft);
            }
        });
    }

    window.addEventListener("beforeunload", handleBeforeUnload);

    function getItemRemainingTimeFromLocalStorage(itemId) {
        const itemData = loadItemDataFromLocalStorage(itemId);
        return itemData ? itemData.remainingTime : null;
    }

    function saveItemRemainingTimeToSessionStorage(itemId, timeLeft) {
        sessionStorage.setItem(`item${itemId}RemainingTime`, timeLeft);
    }

    // Function to restore timer data from session storage on page load
    function restoreTimerDataFromSessionStorage() {
        items.forEach(itemId => {
            const timeLeft = sessionStorage.getItem(`item${itemId}RemainingTime`);
            if (timeLeft) {
                restartItemTimer(itemId, parseInt(timeLeft));
                sessionStorage.removeItem(`item${itemId}RemainingTime`);
            }
        });
    }

    window.addEventListener("load", restoreTimerDataFromSessionStorage);
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
</html>

